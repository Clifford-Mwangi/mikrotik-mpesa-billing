<!DOCTYPE html>
<html>
  <head>
    <title>Test Payment</title>
  </head>
  <body>
    <h2>Test Payment</h2>

    <input type="text" id="phone" placeholder="Phone Number (2547xxxxxxx)" />
    <input type="number" id="amount" placeholder="Amount" />

    <!-- Hidden fields for testing -->
    <input type="hidden" id="userId" value="690e980b64d8b3f60f79e673" />
    <input type="hidden" id="planId" value="690d15acbfdfd25003fd5824" />
    <input type="hidden" id="planName" value="1 Hour Access" />

    <button onclick="makePayment()">Pay Now</button>

    <p id="status"></p>

    <script>
      async function makePayment() {
        const phone = document.getElementById("phone").value;
        const amount = document.getElementById("amount").value;
        const userId = document.getElementById("userId").value;
        const planId = document.getElementById("planId").value;
        const planName = document.getElementById("planName").value;

        if (!phone || !amount) {
          document.getElementById("status").innerText =
            "⚠️ Please enter phone and amount";
          return;
        }

        document.getElementById("status").innerText =
          "⏳ Initiating payment...";

        try {
          const response = await fetch(
            "http://localhost:5000/api/payments/pay",
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ phone, amount, userId, planId, planName }),
            }
          );

          const data = await response.json();
          document.getElementById("status").innerText = JSON.stringify(
            data,
            null,
            2
          );
        } catch (err) {
          console.error(err);
          document.getElementById("status").innerText =
            "❌ Payment request failed";
        }
      }
    </script>
  </body>
</html>
<!DOCTYPE html>
<html>
  <head>
    <title>Test Payment</title>
  </head>
  <body>
    <h2>Test Payment</h2>

    <input type="text" id="phone" placeholder="Phone Number (2547xxxxxxx)" />
    <input type="number" id="amount" placeholder="Amount" />

    <!-- Hidden fields for testing -->
    <input type="hidden" id="userId" value="690e980b64d8b3f60f79e673" />
    <input type="hidden" id="planId" value="690d15acbfdfd25003fd5824" />
    <input type="hidden" id="planName" value="1 Hour Access" />

    <button onclick="makePayment()">Pay Now</button>

    <p id="status"></p>

    <script>
      async function makePayment() {
        const phone = document.getElementById("phone").value;
        const amount = document.getElementById("amount").value;
        const userId = document.getElementById("userId").value;
        const planId = document.getElementById("planId").value;
        const planName = document.getElementById("planName").value;

        if (!phone || !amount) {
          document.getElementById("status").innerText =
            "⚠️ Please enter phone and amount";
          return;
        }

        document.getElementById("status").innerText =
          "⏳ Initiating payment...";

        try {
          const response = await fetch(
            "http://localhost:5000/api/payments/pay",
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ phone, amount, userId, planId, planName }),
            }
          );

          const data = await response.json();
          document.getElementById("status").innerText = JSON.stringify(
            data,
            null,
            2
          );
        } catch (err) {
          console.error(err);
          document.getElementById("status").innerText =
            "❌ Payment request failed";
        }
      }
    </script>
  </body>
</html>
